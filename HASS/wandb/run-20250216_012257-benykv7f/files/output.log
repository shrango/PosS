trainable params: 111,616 || all params: 218,219,520 || trainable%: 0.05114849487341921
trainable params: 111,616 || all params: 218,223,616 || trainable%: 0.05114753482959424
trainable params: 111,616 || all params: 218,223,616 || trainable%: 0.05114753482959424
trainable params: 111,616 || all params: 218,223,616 || trainable%: 0.05114753482959424
trainable params: 111,616 || all params: 218,223,616 || trainable%: 0.05114753482959424
✅ Successfully loaded layers.0 weights.
✅ Copied base_model weights to layers.1
✅ Copied base_model weights to layers.2
✅ Copied base_model weights to layers.3
✅ Copied base_model weights to layers.4
load model from /home/jovyan/workspace/project/llama3/standard/checkpoint/state_20/pytorch_model.bin

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 4036/4038 [1:26:00<00:02,  1.26s/it]
Epoch [1/10], Loss: 0.8961
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4038/4038 [1:26:02<00:00,  1.28s/it]
  0%|                                                                                                                                                                                                                               | 0/213 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/jovyan/workspace/my-eagle/HASS/train/main_hass_lora.py", line 534, in <module>
    acces = getkacc(model, data, head, max_length=5)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/workspace/my-eagle/HASS/train/main_hass_lora.py", line 299, in getkacc
    outs = generate(pre_hidden_states, pre_input_ids, head, max_length=max_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/workspace/my-eagle/HASS/train/main_hass_lora.py", line 270, in generate
    out_hidden, past_key_values = model(last_hidden, input_ids=token, past_key_values=past_key_values,
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1523, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1359, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/accelerate/utils/operations.py", line 581, in forward
    return model_forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/accelerate/utils/operations.py", line 569, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/saturn/lib/python3.12/site-packages/torch/amp/autocast_mode.py", line 16, in decorate_autocast
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/workspace/my-eagle/HASS/model/cnets_lora.py", line 669, in forward
    past_key_value = past_key_values[idx] if past_key_values is not None else None
                     ~~~~~~~~~~~~~~~^^^^^
IndexError: tuple index out of range